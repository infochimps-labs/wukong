<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.8">
<meta name="Forrest-skin-name" content="pelt">
<title>Pig Setup</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
<a href="http://www.apache.org/">Apache</a> &gt; <a href="http://hadoop.apache.org/">Hadoop</a> &gt; <a href="http://hadoop.apache.org/pig/">Pig</a><script src="skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script>
</div>
<!--+
    |header
    +-->
<div class="header">
<!--+
    |start group logo
    +-->
<div class="grouplogo">
<a href="http://hadoop.apache.org/"><img class="logoImage" alt="Hadoop" src="images/hadoop-logo.jpg" title="Apache Hadoop"></a>
</div>
<!--+
    |end group logo
    +-->
<!--+
    |start Project Logo
    +-->
<div class="projectlogo">
<a href="http://hadoop.apache.org/pig/"><img class="logoImage" alt="Pig" src="images/pig-logo.gif" title="A platform for analyzing large datasets."></a>
</div>
<!--+
    |end Project Logo
    +-->
<!--+
    |start Search
    +-->
<div class="searchbox">
<form action="http://www.google.com/search" method="get" class="roundtopsmall">
<input value="" name="sitesearch" type="hidden"><input onFocus="getBlank (this, 'Search the site with google');" size="25" name="q" id="query" type="text" value="Search the site with google">&nbsp; 
                    <input name="Search" value="Search" type="submit">
</form>
</div>
<!--+
    |end search
    +-->
<!--+
    |start Tabs
    +-->
<ul id="tabs">
<li>
<a class="unselected" href="http://hadoop.apache.org/pig/">Project</a>
</li>
<li>
<a class="unselected" href="http://wiki.apache.org/pig/">Wiki</a>
</li>
<li class="current">
<a class="selected" href="index.html">Pig 0.7.0 Documentation</a>
</li>
</ul>
<!--+
    |end Tabs
    +-->
</div>
</div>
<div id="main">
<div id="publishedStrip">
<!--+
    |start Subtabs
    +-->
<div id="level2tabs"></div>
<!--+
    |end Endtabs
    +-->
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<!--+
    |breadtrail
    +-->
<div class="breadtrail">

             &nbsp;
           </div>
<!--+
    |start Menu, mainarea
    +-->
<!--+
    |start Menu
    +-->
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Pig</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html">Overview</a>
</div>
<div class="menupage">
<div class="menupagetitle">Setup</div>
</div>
<div class="menuitem">
<a href="tutorial.html">Tutorial</a>
</div>
<div class="menuitem">
<a href="piglatin_ref1.html">Pig Latin 1</a>
</div>
<div class="menuitem">
<a href="piglatin_ref2.html">Pig Latin 2</a>
</div>
<div class="menuitem">
<a href="cookbook.html">Cookbook</a>
</div>
<div class="menuitem">
<a href="udf.html">UDFs</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.2', 'skin/')" id="menu_1.2Title" class="menutitle">Zebra</div>
<div id="menu_1.2" class="menuitemgroup">
<div class="menuitem">
<a href="zebra_overview.html">Zebra Overview </a>
</div>
<div class="menuitem">
<a href="zebra_users.html">Zebra Users </a>
</div>
<div class="menuitem">
<a href="zebra_reference.html">Zebra Reference </a>
</div>
<div class="menuitem">
<a href="zebra_mapreduce.html">Zebra MapReduce </a>
</div>
<div class="menuitem">
<a href="zebra_pig.html">Zebra Pig </a>
</div>
<div class="menuitem">
<a href="zebra_stream.html">Zebra Streaming </a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.3', 'skin/')" id="menu_1.3Title" class="menutitle">Miscellaneous</div>
<div id="menu_1.3" class="menuitemgroup">
<div class="menuitem">
<a href="api/">API Docs</a>
</div>
<div class="menuitem">
<a href="http://wiki.apache.org/pig/">Wiki</a>
</div>
<div class="menuitem">
<a href="http://wiki.apache.org/pig/FAQ">FAQ</a>
</div>
<div class="menuitem">
<a href="http://hadoop.apache.org/pig/releases.html">Release Notes</a>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<!--+
  |alternative credits
  +-->
<div id="credit2"></div>
</div>
<!--+
    |end Menu
    +-->
<!--+
    |start content
    +-->
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="setup.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Pig Setup</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#Overview">Overview</a>
<ul class="minitoc">
<li>
<a href="#req">Requirements</a>
</li>
</ul>
</li>
<li>
<a href="#Beginning+Pig">Beginning Pig</a>
<ul class="minitoc">
<li>
<a href="#Download+Pig">Download Pig</a>
</li>
<li>
<a href="#Run+Modes">Run Modes</a>
</li>
<li>
<a href="#Grunt+Shell">Grunt Shell</a>
</li>
<li>
<a href="#Script+Files">Script Files</a>
</li>
</ul>
</li>
<li>
<a href="#Advanced+Pig">Advanced Pig</a>
<ul class="minitoc">
<li>
<a href="#Build+Pig">Build Pig</a>
</li>
<li>
<a href="#Environment+Variables+and+Properties">Environment Variables and Properties</a>
</li>
<li>
<a href="#Run+Modes-N1012B">Run Modes</a>
</li>
<li>
<a href="#Embedded+Programs">Embedded Programs</a>
</li>
</ul>
</li>
<li>
<a href="#Sample+Code">Sample Code</a>
</li>
</ul>
</div>
 

<a name="N1000D"></a><a name="Overview"></a>
<h2 class="h3">Overview</h2>
<div class="section">
<a name="N10013"></a><a name="req"></a>
<h3 class="h4">Requirements</h3>
<p>
<strong>Unix</strong> and <strong>Windows</strong> users need the following:</p>
<ol>
		  
<li> 
<strong>Hadoop 0.20.2</strong> - <a href="http://hadoop.apache.org/common/releases.html">http://hadoop.apache.org/common/releases.html</a>
</li>
		  
<li> 
<strong>Java 1.6</strong> - <a href="http://java.sun.com/javase/downloads/index.jsp">http://java.sun.com/javase/downloads/index.jsp</a> (set JAVA_HOME to the root of your Java installation)</li>
		  
<li> 
<strong>Ant 1.7</strong> - <a href="http://ant.apache.org/">http://ant.apache.org/</a> (optional, for builds) </li>
		  
<li> 
<strong>JUnit 4.5</strong> - <a href="http://junit.sourceforge.net/">http://junit.sourceforge.net/</a> (optional, for unit tests) </li>
		
</ol>
<p>
<strong>Windows</strong> users need to install Cygwin and the Perl package: <a href="http://www.cygwin.com/"> http://www.cygwin.com/</a>
</p>
</div>      
        
        

<a name="N10055"></a><a name="Beginning+Pig"></a>
<h2 class="h3">Beginning Pig</h2>
<div class="section">
<a name="N1005B"></a><a name="Download+Pig"></a>
<h3 class="h4">Download Pig</h3>
<p>To get a Pig distribution, download a recent stable release from one of the Apache Download Mirrors (see <a href="http://hadoop.apache.org/pig/releases.html"> Pig Releases</a>).</p>
<p>Unpack the downloaded Pig distribution. The Pig script is located in the bin directory (/pig-n.n.n/bin/pig).</p>
<p>Add /pig-n.n.n/bin to your path. Use export (bash,sh,ksh) or setenv (tcsh,csh). For example: </p>
<pre class="code">
$ export PATH=/&lt;my-path-to-pig&gt;/pig-n.n.n/bin:$PATH
</pre>
<p>Try the following command, to get a list of Pig commands: </p>
<pre class="code">
$ pig -help
</pre>
<p>Try the following command, to start the Grunt shell:</p>
<pre class="code">
$ pig 
</pre>
<a name="N10081"></a><a name="Run+Modes"></a>
<h3 class="h4">Run Modes</h3>
<p>Pig has two run modes or exectypes:  </p>
<ul>
      
<li>
<p> Local Mode - To run Pig in local mode, you need access to a single machine.  </p>
</li>
      
<li>
<p> Mapreduce Mode - To run Pig in mapreduce mode, you need access to a Hadoop cluster and HDFS installation. 
      Pig will automatically allocate and deallocate a 15-node cluster.</p>
</li>
    
</ul>
<p>You can run the Grunt shell, Pig scripts, or embedded programs using either mode.</p>
<a name="N10099"></a><a name="Grunt+Shell"></a>
<h3 class="h4">Grunt Shell</h3>
<p>Use Pig's interactive shell, Grunt, to enter pig commands manually. See the <a href="setup.html#Sample+Code">Sample Code</a> for instructions about the passwd file used in the example.</p>
<p>You can also run or execute script files from the Grunt shell. 
See the <a href="piglatin_ref2.html#run">run</a> and <a href="piglatin_ref2.html#exec">exec</a> commands. </p>
<p>
<strong>Local Mode</strong>
</p>
<pre class="code">
$ pig -x local
</pre>
<p>
<strong>Mapreduce Mode</strong> 
</p>
<pre class="code">
$ pig
or
$ pig -x mapreduce
</pre>
<p>For either mode, the Grunt shell is invoked and you can enter commands at the prompt. The results are displayed to your terminal screen (if DUMP is used) or to a file (if STORE is used).
</p>
<pre class="code">
grunt&gt; A = load 'passwd' using PigStorage(':'); 
grunt&gt; B = foreach A generate $0 as id; 
grunt&gt; dump B; 
grunt&gt; store B; 
</pre>
<a name="N100CA"></a><a name="Script+Files"></a>
<h3 class="h4">Script Files</h3>
<p>Use script files to run Pig commands as batch jobs. See the <a href="setup.html#Sample+Code">Sample Code</a> for instructions about the passwd file and the script file (id.pig) used in the example.</p>
<p>
<strong>Local Mode</strong>
</p>
<pre class="code">
$ pig -x local id.pig
</pre>
<p>
<strong>Mapreduce Mode</strong> 
</p>
<pre class="code">
$ pig id.pig
or
$ pig -x mapreduce id.pig
</pre>
<p>For either mode, the Pig Latin statements are executed and the results are displayed to your terminal screen (if DUMP is used) or to a file (if STORE is used).</p>
</div>



<a name="N100ED"></a><a name="Advanced+Pig"></a>
<h2 class="h3">Advanced Pig</h2>
<div class="section">
<a name="N100F3"></a><a name="Build+Pig"></a>
<h3 class="h4">Build Pig</h3>
<p>To build pig, do the following:</p>
<ol>
	  
<li> Check out the Pig code from SVN: <em>svn co http://svn.apache.org/repos/asf/hadoop/pig/trunk</em>. </li>
	  
<li> Build the code from the top directory: <em>ant</em>. If the build is successful, you should see the <em>pig.jar</em> created in that directory. </li>	
	  
<li> Validate your <em>pig.jar</em> by running a unit test: <em>ant test</em>
</li>
     
</ol>
<a name="N10117"></a><a name="Environment+Variables+and+Properties"></a>
<h3 class="h4">Environment Variables and Properties</h3>
<p>See <a href="setup.html#Download+Pig">Download Pig</a>.</p>
<p>The Pig environment variables are described in the Pig script file, located in the  /pig-n.n.n/bin directory.</p>
<p>The Pig properties file, pig.properties, is located in the /pig-n.n.n/conf directory. You can specify an alternate location using the PIG_CONF_DIR environment variable.</p>
<a name="N1012B"></a><a name="Run+Modes-N1012B"></a>
<h3 class="h4">Run Modes</h3>
<p>See <a href="setup.html#Run+Modes">Run Modes</a>. </p>
<a name="N10139"></a><a name="Embedded+Programs"></a>
<h3 class="h4">Embedded Programs</h3>
<p>Used the embedded option to embed Pig commands in a host language and run the program. 
See the <a href="setup.html#Sample+Code">Sample Code</a> for instructions about the passwd file and java files (idlocal.java, idmapreduce.java) used in the examples.</p>
<p>
<strong>Local Mode</strong>
</p>
<p>From your current working directory, compile the program: </p>
<pre class="code">
$ javac -cp pig.jar idlocal.java
</pre>
<p>Note: idlocal.class is written to your current working directory. Include &ldquo;.&rdquo; in the class path when you run the program. </p>
<p>From your current working directory, run the program: 
</p>
<pre class="code">
Unix:   $ java -cp pig.jar:. idlocal
Cygwin: $ java &ndash;cp &lsquo;.;pig.jar&rsquo; idlocal
</pre>
<p>To view the results, check the output file, id.out. </p>
<p>
<strong>Mapreduce Mode</strong>
</p>
<p>Point $HADOOPDIR to the directory that contains the hadoop-site.xml file. Example: 
</p>
<pre class="code">
$ export HADOOPDIR=/yourHADOOPsite/conf 
</pre>
<p>From your current working directory, compile the program: 
</p>
<pre class="code">
$ javac -cp pig.jar idmapreduce.java
</pre>
<p>Note: idmapreduce.class is written to your current working directory. Include &ldquo;.&rdquo; in the class path when you run the program. </p>
<p>From your current working directory, run the program: 
</p>
<pre class="code">
Unix:   $ java -cp pig.jar:.:$HADOOPDIR idmapreduce
Cygwin: $ java &ndash;cp &lsquo;.;pig.jar;$HADOOPDIR&rsquo; idmapreduce
</pre>
<p>To view the results, check the idout directory on your Hadoop system. </p>
</div>



<a name="N1017F"></a><a name="Sample+Code"></a>
<h2 class="h3">Sample Code</h2>
<div class="section">
<p>The sample code is based on Pig Latin statements that extract all user IDs from the /etc/passwd file. </p>
<p>Copy the /etc/passwd file to your local working directory.</p>
<p>
<strong>id.pig</strong>
</p>
<p>For the Grunt Shell and script files. </p>
<pre class="code">
A = load 'passwd' using PigStorage(':'); 
B = foreach A generate $0 as id;
dump B; 
store B into &lsquo;id.out&rsquo;;
</pre>
<p>
<strong>idlocal.java</strong>
</p>
<p>For embedded programs. </p>
<pre class="code">
import java.io.IOException;
import org.apache.pig.PigServer;
public class idlocal{ 
public static void main(String[] args) {
try {
    PigServer pigServer = new PigServer("local");
    runIdQuery(pigServer, "passwd");
    }
    catch(Exception e) {
    }
 }
public static void runIdQuery(PigServer pigServer, String inputFile) throws IOException {
    pigServer.registerQuery("A = load '" + inputFile + "' using PigStorage(':');");
    pigServer.registerQuery("B = foreach A generate $0 as id;");
    pigServer.store("B", "id.out");
 }
}
</pre>
<p>
<strong>idmapreduce.java</strong>
</p>
<p>For embedded programs. </p>
<pre class="code">
import java.io.IOException;
import org.apache.pig.PigServer;
public class idmapreduce{
   public static void main(String[] args) {
   try {
     PigServer pigServer = new PigServer("mapreduce");
     runIdQuery(pigServer, "passwd");
   }
   catch(Exception e) {
   }
}
public static void runIdQuery(PigServer pigServer, String inputFile) throws IOException {
   pigServer.registerQuery("A = load '" + inputFile + "' using PigStorage(':');")
   pigServer.registerQuery("B = foreach A generate $0 as id;");
   pigServer.store("B", "idout");
   }
}
</pre>
</div>

</div>
<!--+
    |end content
    +-->
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<!--+
    |start bottomstrip
    +-->
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2007-2010 <a href="http://www.apache.org/licenses/">The Apache Software Foundation.</a>
</div>
<!--+
    |end bottomstrip
    +-->
</div>
</body>
</html>
